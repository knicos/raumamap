<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
	<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
   integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
   crossorigin=""></script>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
		#mapouter {
			position: absolute;
			top: 160px;
			bottom: 0;
			left: 0;
			right: 0;
		}
		#menu {
			background: #e21156;
			height: 84px;
		}
		#logo {
			height: 84px;
			background: white;
		}
		#logo img {
			margin: 20px;
		}
		#controls {
			position: absolute;
			bottom: 0;
			z-index: 10000;
			margin: 50px;
		}

		button {
			font-size: 20pt;
			background: white;
			border: 0;
			padding: 10px;
			border-radius: 5px;
		}
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
	<div id="logo"><img src="images/visitrauma_logo.png"></div>
	<div id="menu"></div>
	<div id="mapouter">
    <div id="map"></div>
	<div id="controls">
		<button onclick="updateSea('1000bc')">1000 BC</button>
		<button onclick="updateSea('100ad')">100 AD</button>
		<button onclick="updateSea('1500')">1500</button>
		<button onclick="updateSea('today')">Today</button>
	</div>
	</div>
    <script>
		let markerStyles = {
			"monument": {
				iconUrl: "images/monument.png",
				iconSize: [64,64],
				iconAnchor: [32,63]
			},
			"restaurant": {
				iconUrl: "images/restaurant.png",
				iconSize: [64,64],
				iconAnchor: [32,63]
			},
			"attraction": {
				iconUrl: "images/attraction.png",
				iconSize: [64,64],
				iconAnchor: [32,63]
			}
		};

		var buildings = {
			"1000bc": [
						{
							outline: [[61.12123157831219,21.778078079223633],
[61.12106576742818,21.774473190307617],
[61.119614885081845,21.773786544799805],
[61.11791519532813,21.774644851684574],
[61.11642270944355,21.7774772644043],
[61.11567644007235,21.781425476074222],
[61.11405946265586,21.784257888793945],
[61.11430823379614,21.78743362426758],
[61.11683729592532,21.786317825317386],
[61.12015379201484,21.782283782958988]],
							title: "bronze age site"
						},
						{
							outline: null,
							latlng: [61.1182053927327,21.780309677124027],
							title: "Bronze Age Burials",
							content: "<b>Sammallahdenmäki</b><br>Bronze age site.<br>Open: summer",
							type: "monument"
						}
					 ],
			"1500"	: [
						{
							outline: [[61.12666140397064,21.515275239944458],
[61.12609152334979,21.515135765075687],
[61.12513824551524,21.51494264602661],
[61.12497763609249,21.517571210861206],
[61.12503980757878,21.517689228057865],
[61.12568741995361,21.517882347106937],
[61.12663550052905,21.515940427780155]],
							type: "grass"
						},
						{
							outline: [[61.12844350975825,21.517142057418827],
[61.12839170577609,21.51802182197571],
[61.12843314896861,21.518633365631107],
[61.12813786503558,21.518644094467167],
[61.12761981637937,21.51842951774597],
[61.12730380252767,21.51832222938538],
[61.127117301066384,21.51830077171326],
[61.127086217382484,21.51777505874634],
[61.12692043721843,21.517152786254886],
[61.12712248167741,21.517174243927006]],
							type: "grass"
						},
						{
							outline: [[61.12123157831219,21.778078079223633],
[61.12106576742818,21.774473190307617],
[61.119614885081845,21.773786544799805],
[61.11791519532813,21.774644851684574],
[61.11642270944355,21.7774772644043],
[61.11567644007235,21.781425476074222],
[61.11405946265586,21.784257888793945],
[61.11430823379614,21.78743362426758],
[61.11683729592532,21.786317825317386],
[61.12015379201484,21.782283782958988]],
							title: "bronze age site"
						},
						{
							outline: null,
							latlng: [61.12730380252767,21.510275602340702],
							title: "Seppä House",
							content: "<b>Seppä House</b><br><a href='http://www.sepantalo.fi'>http://www.sepantalo.fi</a>",
							type: "monument"
						},
						{
							outline: null,
							latlng: [61.1182053927327,21.780309677124027],
							title: "Bronze Age Burials",
							content: "<b>Sammallahdenmäki</b><br>Bronze age site.<br>Open: summer",
							type: "monument"
						},
						{
							outline: [[61.12889420081871,21.509943008422855],
[61.12886570904551,21.510377526283268],
[61.12902629870419,21.510415077209473],
[61.1290496100384,21.51007175445557],
[61.12902888885327,21.510061025619507],
[61.12903665929929,21.50998055934906]],
							title: "Some name (1590)"
						},
						{
							outline: [[61.12693597914578,21.515913605690002],
[61.12695929202243,21.516214013099674],
[61.12699296614725,21.516192555427555],
[61.127011098353414,21.51628911495209],
[61.12696447265935,21.51629984378815],
[61.12697224361314,21.516401767730716],
[61.12686085975949,21.51643395423889],
[61.12682200483446,21.515940427780155]],
							title: "Holy Trinity Church (1400)"
						},
						{
							outline: [[61.12864554447702,21.515237689018253],
[61.12863000339067,21.51558637619019],
[61.12852898614309,21.51557564735413],
[61.12854193709033,21.515221595764164]],
							title: "Random house (1570)"
						},
						{
							outline: [[61.128381344969476,21.512587666511536],
[61.12837875476727,21.512727141380314],
[61.12836062334601,21.512721776962284],
[61.128326950678925,21.513102650642395],
[61.12823888353378,21.51305437088013],
[61.12828809755694,21.51255011558533]],
							title: "Random house2 (1575)"
						}
					],
			"today"	: [
						{
							outline: [[61.12123157831219,21.778078079223633],
[61.12106576742818,21.774473190307617],
[61.119614885081845,21.773786544799805],
[61.11791519532813,21.774644851684574],
[61.11642270944355,21.7774772644043],
[61.11567644007235,21.781425476074222],
[61.11405946265586,21.784257888793945],
[61.11430823379614,21.78743362426758],
[61.11683729592532,21.786317825317386],
[61.12015379201484,21.782283782958988]],
							title: "bronze age site"
						},
						{
							outline: null,
							latlng: [61.12730380252767,21.510275602340702],
							title: "Seppä House",
							content: "<b>Seppä House</b><br><a href='http://www.sepantalo.fi'>http://www.sepantalo.fi</a>",
							type: "monument"
						},
						{
							outline: null,
							latlng: [61.1182053927327,21.780309677124027],
							title: "Bronze Age Burials",
							content: "<b>Sammallahdenmäki</b><br>Bronze age site.<br>Open: summer",
							type: "monument"
						},
						{
							outline: null,
							latlng: [61.128682, 21.510828],
							title: "Taruliina",
							content: "<b>Taruliina</b><br>Lace shop.<br>Open: 9am-5pm",
							type: "attraction"
						},
						{
							outline: null,
							latlng: [61.128004, 21.516878],
							title: "Pits-Priia-Nyplaajat",
							content: "<b>Pits-Priia-Nyplaajat</b><br>Lace shop.<br>Open: 9am-5pm",
							type: "attraction"
						},
						{
							outline: null,
							latlng: [61.12966965, 21.512319050790182],
							title: "Church of Holy Spirit",
							content: "<b>Church of Holy Spirit</b><br>Church.<br>Open: ",
							type: "attraction"
						},
						{
							outline: null,
							latlng: [61.1287068, 21.4945654],
							title: "Rauma Maritime Museum",
							content: "<b>Rauma Maritime Museum</b><br>Museum.<br><br>Seasonal opening times:<br>MON  10:30–21TUE    10:30–21<br>WED	10:30–21<br>THU	10:30–21<br>FRI	10:30–23<br>SAT	11–23<br>SUN    Closed<br><br><a href='https://www.rmm.fi/english/maritimemuseum'>https://www.rmm.fi/english/maritimemuseum</a>",
							type: "monument"
						},
						{
							outline: null,
							latlng: [61.128682, 21.510828],
							title: "Restaurant Ravintola Goto",
							content: "<b>Restaurant Ravintola Goto</b><br>Chinese Food.<br>Open: 11am-10pm",
							type: "restaurant"
						},
						{
							outline: null,
							latlng: [61.127545, 21.508535],
							title: "Restaurant Ravintola Savila",
							content: "<b>Restaurant Ravintola Savila</b><br>Indian Food.<br><br>Open:<br>MON  10:30–21<br>TUE    10:30–21<br>WED	10:30–21<br>THU	10:30–21<br>FRI	10:30–23<br>SAT	11–23<br>SUN    Closed",
							type: "restaurant"
						}
					]
		};

		var seas = {
			"today": null,
			"1000bc": [
					[[60.1279102, 20.5072944],[60.1279102, 22.5072944],[62.1279102, 22.5072944],[62.1279102, 20.5072944]],
					[[61.09215993431435,21.6236686706543],
[61.09381952043946,21.61645889282227],
[61.09265781929258,21.60495758056641],
[61.09050026113363,21.595859527587894],
[61.08942142688107,21.589851379394535],
[61.08925544911592,21.586074829101566],
[61.09141309215637,21.579036712646488],
[61.09141309215637,21.57371520996094],
[61.092491858503735,21.5716552734375],
[61.095064152904925,21.574058532714847],
[61.100042193123514,21.57766342163086],
[61.10311159410049,21.5797233581543],
[61.106180697201275,21.58143997192383],
[61.107341901781304,21.58401489257813],
[61.10427291138521,21.590366363525394],
[61.105765970945214,21.59500122070313],
[61.109166565679764,21.597747802734375],
[61.111074056260286,21.599636077880863],
[61.11016179251506,21.606502532958988],
[61.107590725786196,21.612854003906254],
[61.10634658618068,21.61645889282227],
[61.10327749918075,21.619033813476562],
[61.10037403461751,21.61886215209961],
[61.09589388067868,21.622295379638675],
[61.093404632069486,21.626243591308597]],
					[[61.18545920851179,21.75189971923828],
[61.176853419901825,21.759452819824222],
[61.172053017259486,21.753273010253906],
[61.16592730452245,21.750183105468754],
[61.162118829339086,21.753273010253906],
[61.16112523845365,21.75979614257813],
[61.160297222145196,21.76425933837891],
[61.15847550977194,21.7584228515625],
[61.15615681462591,21.757736206054688],
[61.154997403157644,21.7529296875],
[61.14870271186268,21.746749877929688],
[61.145886259288694,21.748466491699222],
[61.14340094539028,21.749839782714847],
[61.14306955542129,21.741943359375],
[61.14108114256161,21.740226745605472],
[61.14074972824382,21.736793518066406],
[61.13809828847313,21.73301696777344],
[61.13511515260941,21.73301696777344],
[61.13262899079795,21.7364501953125],
[61.13047415892817,21.73954010009766],
[61.12881649592217,21.74091339111328],
[61.12848495288281,21.744346618652347],
[61.13047415892817,21.74640655517578],
[61.133291986415756,21.7474365234375],
[61.13461793590267,21.753616333007816],
[61.13511515260941,21.760139465332035],
[61.133291986415756,21.76425933837891],
[61.12947957156264,21.76528930664063],
[61.12699296614725,21.767349243164062],
[61.12566669656321,21.768035888671875],
[61.123511389745026,21.76769256591797],
[61.12201916813026,21.768550872802734],
[61.12044396886473,21.770095825195316],
[61.11978070357848,21.77095413208008],
[61.119366155705585,21.769924163818363],
[61.120526876046746,21.76700592041016],
[61.119614885081845,21.76425933837891],
[61.11787373833852,21.765117645263675],
[61.11621541416337,21.767864227294922],
[61.114888692176486,21.771297454833988],
[61.11372776475666,21.776103973388675],
[61.11314728505792,21.78022384643555],
[61.11356191450186,21.78125381469727],
[61.11140578200479,21.78863525390625],
[61.111074056260286,21.794300079345703],
[61.11148871289706,21.79824829101563],
[61.11182043429061,21.800479888916016],
[61.11256679469979,21.801338195800785],
[61.11356191450186,21.798763275146488],
[61.115303298779416,21.796016693115238],
[61.11621541416337,21.792068481445316],
[61.1177908241962,21.788978576660156],
[61.11911742437175,21.787605285644535],
[61.12235077902336,21.785545349121097],
[61.124423268264394,21.785545349121097],
[61.1243403713046,21.789321899414062],
[61.12268238643654,21.795501708984375],
[61.121355935904226,21.798591613769535],
[61.1200294296921,21.80168151855469],
[61.117956652263345,21.804256439208988],
[61.11555206013081,21.805973052978516],
[61.11389361414133,21.805973052978516],
[61.11140578200479,21.805973052978516],
[61.10891775407594,21.81266784667969],
[61.10667836152867,21.820049285888675],
[61.10501944997711,21.823825836181644],
[61.103028641234,21.825370788574222],
[61.10219910060154,21.825714111328125],
[61.1002081143057,21.825714111328125],
[61.09929553703233,21.824340820312504],
[61.09755327094022,21.820392608642578],
[61.099876271070926,21.816787719726562],
[61.100456994447,21.810951232910156],
[61.10037403461751,21.80665969848633],
[61.10294568814988,21.804084777832035],
[61.1041899615649,21.800994873046875],
[61.10452175954074,21.79841995239258],
[61.10360930673026,21.792583465576175],
[61.106595418018024,21.78571701049805],
[61.10360930673026,21.77627563476563],
[61.10501944997711,21.769065856933594],
[61.107590725786196,21.76219940185547],
[61.11041059432891,21.757564544677734],
[61.11331313748811,21.752758026123047],
[61.11372776475666,21.74829483032227],
[61.11306435851652,21.727180480957035],
[61.11306435851652,21.715164184570312],
[61.11206922305156,21.70520782470703],
[61.105765970945214,21.688385009765625],
[61.105102397621636,21.67465209960938],
[61.10112066524941,21.665725708007816],
[61.09630873640474,21.65061950683594],
[61.085188721904466,21.623497009277347],
[61.082034573644655,21.605644226074222],
[61.08170253975298,21.583671569824222],
[61.08153652150103,21.560325622558597],
[61.079378204985225,21.54041290283203],
[61.07223810956605,21.527366638183597],
[61.064099758656226,21.52496337890625],
[61.05429774447099,21.519813537597656],
[61.04798297706485,21.519813537597656],
[61.04050333567757,21.514320373535156],
[61.03352074474647,21.511230468750004],
[60.95010977746489,21.51260375976563],
[60.941439802763774,22.081146240234375],
[61.27188302751039,22.10105895996094],
[61.21870180571184,21.851806640625004],
[61.19919050401565,21.85935974121094],
[61.201836812828375,21.831893920898438]]],
			"1500": [
				  [[60.1279102, 20.5072944],[60.1279102, 22.5072944],[62.1279102, 22.5072944],[62.1279102, 20.5072944]], // outer ring
					[[61.13094036097638,21.51532888412476],
						[61.1307331609155,21.514899730682377],
						[61.13046379880451,21.514856815338135],
						[61.13028767618237,21.51423454284668],
						[61.13023587522427,21.5133547782898],
						[61.129945788289206,21.5122389793396],
						[61.129966508872904,21.51118755340576],
						[61.129811104163835,21.510951519012455],
						[61.12962461750378,21.511166095733646],
						[61.12944849020291,21.511766910552982],
						[61.129469211112806,21.512625217437748],
						[61.129438129742844,21.51378393173218],
						[61.12941740881257,21.51453495025635],
						[61.12936560642743,21.515886783599854],
						[61.129396687868706,21.51655197143555],
						[61.129282722434475,21.517903804779053],
						[61.12926200140224,21.519169807434086],
						[61.129137674923534,21.520156860351566],
						[61.128992626746616,21.520457267761234],
						[61.128899381138346,21.520800590515137],
						[61.12906515091832,21.521186828613285],
						[61.12912731436155,21.522474288940433],
						[61.129137674923534,21.523590087890625],
						[61.12906515091832,21.52429819107056],
						[61.12860928193031,21.525135040283203],
						[61.128277736716306,21.525328159332275],
						[61.12812232369949,21.52554273605347],
						[61.12786330030582,21.525135040283203],
						[61.127946188022854,21.524169445037845],
						[61.127987631799826,21.5232253074646],
						[61.12813268459107,21.52202367782593],
						[61.12811196280451,21.521122455596924],
						[61.127987631799826,21.520907878875736],
						[61.12781149537224,21.520392894744877],
						[61.12809124100436,21.52032852172852],
						[61.12809124100436,21.52007102966309],
						[61.127790773375025,21.519255638122562],
						[61.12793582707011,21.518912315368656],
						[61.128495313655456,21.519384384155273],
						[61.128547117467726,21.518762111663822],
						[61.128775053232545,21.51824712753296],
						[61.12905479033256,21.517496109008793],
						[61.12911695379617,21.516723632812504],
						[61.129013347955535,21.515865325927738],
						[61.12884757790372,21.51560783386231],
						[61.12897190552411,21.51427745819092],
						[61.12916875658906,21.513805389404297],
						[61.12915839603729,21.51249647140503],
						[61.12915839603729,21.51146650314331],
						[61.12926200140224,21.51080131530762],
						[61.1296142571015,21.509728431701664],
						[61.129707500599714,21.508891582489017],
						[61.12914803548212,21.508162021636966],
						[61.128598921195064,21.508376598358158],
						[61.128308819227925,21.50859117507935],
						[61.12800835366791,21.50904178619385],
						[61.12766644110629,21.508827209472656],
						[61.127479941785744,21.509492397308353],
						[61.127106939841816,21.509428024291996],
						[61.12723127431244,21.50878429412842],
						[61.1271691071383,21.507732868194584],
						[61.126899714636764,21.50758266448975],
						[61.12672357214378,21.508526802062992],
						[61.12638164567757,21.508398056030273],
						[61.12595682279199,21.50794744491577],
						[61.125759951712986,21.50822639465332],
						[61.12466159581231,21.507132053375248],
						[61.123490664927374,21.506381034851074],
						[61.12179118362263,21.50582313537598],
						[61.12039215176552,21.50595188140869],
						[61.11788410259103,21.507754325866703],
						[61.116132495670655,21.50970697402954],
						[61.11369666790017,21.509406566619877],
						[61.094649280857126,21.504707336425785],
						[61.09332165374258,21.629676818847656],
						[61.15830989434055,21.62864685058594],
						[61.15251280656683,21.50161743164063],
						[61.14733593537941,21.51183128356934],
						[61.13706250934372,21.520929336547855]]
					]
		};

		var mymap = L.map('map').setView([61.1194085,21.7659945],14); //[61.1279102, 21.5072944], 16);

		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
			attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
			maxZoom: 18,
			//id: 'mapbox.satellite',
			id: 'mapbox.outdoors',
			accessToken: 'pk.eyJ1Ijoia25pY29zIiwiYSI6ImNqbGR4ODltdjBnMTEzcHAxNXcxMXU2NTMifQ.8YydiONHUC_SiSA6vxHHZA'
		}).addTo(mymap);

		var imageUrl = 'images/overlay1550_new.jpg',
		imageBounds = [[61.13090928105388,21.52245283126831], [61.12561488802771, 21.50700330734253]];
		var overlay = L.imageOverlay(imageUrl, imageBounds, {
			opacity: 0.6
		});
		//overlay.addTo(mymap);

		// Sea polygon
		var latlngs = [];
		var sea = L.polygon(latlngs, {color: '#24458f', fillOpacity: 0.8, stroke: 0}).addTo(mymap);
		var markers = [];
		var outlines = [];

		function updateSea(date) {
			if (seas[date]) {
				sea.setLatLngs(seas[date]);
			} else {
				sea.setLatLngs([]);
			}

			for (var i=0; i<markers.length; i++) {
				markers[i].removeFrom(mymap);
			}
			markers = [];

			if (buildings[date]) {
				let bs = buildings[date];
				for (var i=0; i<bs.length; i++) {
					let b = bs[i];
					if (b.outline == null) {
						let o = {
							title: b.title
						};

						if (b.type) {
							o.icon = L.icon(markerStyles[b.type]);
						}

						let m = L.marker(b.latlng,o);
						if (b.content) {
							m.bindPopup(b.content).openPopup();
						}
						m.addTo(mymap);
						markers.push(m);
					} else {
						let col, op;
						switch(b.type) {
						case "grass":	col = "#cbe8ca"; op = 0.8; break;
						default: col = "orange"; op = 0.2;
						}

						let m = L.polygon(b.outline, {color: col, fillOpacity: op});
						m.addTo(mymap);
						markers.push(m);
					}
				}
			}

			switch(date) {
			case "today": mymap.flyTo([61.1279102, 21.5072944], 16); break;
			case "1500": mymap.flyTo([61.1281124,21.512096], 17); break;
			case "1000bc": mymap.flyTo([61.1194085,21.7659945],14); break;
			}
		}

		updateSea("1000bc");

		let mousemode = "none";
		let coordlog = "";

		mymap.on('click', function(e) {
			console.log("["+e.latlng.lat+","+e.latlng.lng+"],");
			coordlog += "["+e.latlng.lat+","+e.latlng.lng+"],\n";

			switch(mousemode) {
			case "overlay_tr"	: console.log(overlay.getBounds());
								  overlay.setBounds(L.latLngBounds(e.latlng,overlay.getBounds()._southWest)); break;
			case "overlay_bl"	: console.log(overlay.getBounds());
								  overlay.setBounds(L.latLngBounds(overlay.getBounds()._northEast, e.latlng)); break;
			}
		});

		// Markers
		/*L.marker([61.128682, 21.510828],{
			title: "Taruliina"
		}).addTo(mymap);

		L.marker([61.128004, 21.516878],{
			title: "Pits-Priia-Nyplaajat"
		}).addTo(mymap);*/

      /*var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          //center: {lat: 61.1203375, lng: 21.7597812},
		  center: {lat: 61.1279102, lng: 21.5072944},
          zoom: 14,
		  mapTypeId: 'satellite'
        });

		var imageBounds = {
			north: 61.1289102,
			south: 61.1279102,
			east: 21.5072944,
			west: 21.5082944
		  };

		// Define the LatLng coordinates for the outer path.
		  var outerCoords = [
			{lat: 62.1289102, lng: 20.5082944}, // north west
			{lat: 60.1279102, lng: 20.5082944}, // south west
			{lat: 60.1279102, lng: 22.5072944}, // south east
			{lat: 62.1289102, lng: 22.5072944}  // north east
		  ];

		  var innerCoords1 = [
			{lat: 61.1289102, lng: 21.5082944}, // north west
			{lat: 61.1279102, lng: 21.5082944}, // south west
			{lat: 61.1279102, lng: 21.5072944}, // south east
			{lat: 61.1289102, lng: 21.5072944}  // north east
		  ];

		map.data.add({geometry: new google.maps.Data.Polygon([outerCoords, innerCoords1])});

		var marker = new google.maps.Marker({
			position: {lat: 61.1289102, lng: 21.5082944},
			map: map,
			title: 'Museum'
		  });

		map.data.setStyle({
		  fillColor: 'blue',
		  strokeWeight: 0,
		  fillOpacity: 0.8
		});

		map.on('mousemove', function(e) {
			console.log(JSON.stringify(e.lngLat));
		});
	}*/
    </script>
    <!--script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAIvLmQPB_FAHyVWhh-h8o1OP8P2oO5GJk&callback=initMap"
    async defer></script-->
  </body>
</html>
